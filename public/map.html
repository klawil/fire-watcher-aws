<html>
	<head>
		<title>Test Map Page</title>
	</head>
	<body>
		<script>
			const geoOptions = {
				enableHighAccuracy: true,
				timeout: 5000
			}

			function sharePosition(pos) {
				const coords = pos.coords;
				fetch('/api?action=location', {
					method: 'POST',
					body: JSON.stringify({
						lat: coords.latitude,
						lng: coords.longitude,
						acc: coords.accuracy
					})
				})
					.then(r => r.json())
					.then(console.log)
					.catch(console.error)
					.then(() => setTimeout(getPosition, 10000));
			}

			function onError(err) {
				console.error(err);
			}

			function getPosition() {
				navigator.geolocation.getCurrentPosition(sharePosition, onError, geoOptions);
			}

			getPosition();
		</script>
	</body>
</html>
